---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
```{r, echo=TRUE}
unzip("activity.zip")
activity <- read.csv("activity.csv")
```

## What is mean total number of steps taken per day?
```{r, echo=TRUE}
totalStepsByDay <- aggregate(steps ~ date, activity, "sum")
hist(totalStepsByDay$steps, 
     main = "Histogram of Total Steps Per Day",
     xlab = "Steps Per Day")
mean <- mean(totalStepsByDay$steps)
median <- median(totalStepsByDay$steps)
```
The mean is `r format(mean, nsmall=2)` steps per day.  
The median is `r median` steps per day.

## What is the average daily activity pattern?
```{r, echo=TRUE}
meanStepsByInterval <- aggregate(steps ~ interval, activity, "mean")
plot(meanStepsByInterval,
     main="Average Daily Activity in 5-minute Intervals",
     xlab="Interval",
     ylab="Average Step Count",
     type="l")
maxInterval <- meanStepsByInterval$interval[which.max(meanStepsByInterval$steps)]
```
The interval with the maximum number of steps is interval `r maxInterval`


## Imputing missing values
The number of rows with missing values is `r sum(is.na(activity$steps))`
```{r, echo=TRUE}
imputed <- activity
inds <- which(is.na(imputed$steps))
for (i in inds) {
    interval <- imputed$interval[i]
    value <- meanStepsByInterval$steps[meanStepsByInterval$interval == interval]
    imputed$steps[i] <- value
}
totalStepsByDay <- aggregate(steps ~ date, imputed, "sum")
hist(totalStepsByDay$steps, 
     main = "Histogram of Total Steps Per Day",
     xlab = "Steps Per Day")
mean <- mean(totalStepsByDay$steps)
median <- median(totalStepsByDay$steps)
```
The mean is `r format(mean, nsmall=2)` steps per day.  
The median is `r format(median, nsmall=2)` steps per day.



## Are there differences in activity patterns between weekdays and weekends?
```{r, echo=TRUE}
days <- weekdays(as.POSIXlt(imputed$date))
imputed$dayType <- as.factor(ifelse(days %in% c("Saturday", "Sunday"), "weekend", "weekday"))
meanStepsByInterval <- aggregate(steps ~ interval, imputed[imputed$dayType == "weekday",], "mean")
par(mfrow=c(2,1))
plot(meanStepsByInterval,
     main="Average Daily Activity in 5-minute Intervals (Weekdays)",
     xlab="Interval",
     ylab="Average Step Count",
     type="l")
meanStepsByInterval <- aggregate(steps ~ interval, imputed[imputed$dayType == "weekend",], "mean")
plot(meanStepsByInterval,
     main="Average Daily Activity in 5-minute Intervals (Weekends)",
     xlab="Interval",
     ylab="Average Step Count",
     type="l")
```
